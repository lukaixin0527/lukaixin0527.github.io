<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Prometheus+Grafanaæ­å»ºæœåŠ¡ç›‘æ§ | Hexo</title>
  <meta name="keywords" content=" æœåŠ¡ç›‘æ§ ">
  <meta name="description" content="Prometheus+Grafanaæ­å»ºæœåŠ¡ç›‘æ§ | Hexo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å™¨ XXL-JOBåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° PowerJobåˆ†å¸ƒå¼è°ƒåº¦ä¸è®¡ç®—æ¡†æ¶  æ•°æ®å¯è§†åŒ–å¹³å° GoViewä½ä»£ç æ•°æ®å¯è§†åŒ– 100å¥—å¤§æ•°æ®å¯è§†åŒ–æ¨¡æ¿  ç®¡ç†åå° è‹¥ä¾ç®¡ç†ç³»ç»Ÿ ç®€å•æ˜“ç”¨çš„javaåˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿ">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¼˜ç§€çš„å¼€æºé¡¹ç›®">
<meta property="og:url" content="http://example.com/2099/03/23/2099-03-23-%E4%BC%98%E7%A7%80%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å™¨ XXL-JOBåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° PowerJobåˆ†å¸ƒå¼è°ƒåº¦ä¸è®¡ç®—æ¡†æ¶  æ•°æ®å¯è§†åŒ–å¹³å° GoViewä½ä»£ç æ•°æ®å¯è§†åŒ– 100å¥—å¤§æ•°æ®å¯è§†åŒ–æ¨¡æ¿  ç®¡ç†åå° è‹¥ä¾ç®¡ç†ç³»ç»Ÿ ç®€å•æ˜“ç”¨çš„javaåˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿ">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2099-03-22T16:00:00.000Z">
<meta property="article:modified_time" content="2022-12-28T08:44:37.017Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="å¼€æº">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>John Doe</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/yelog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="facebook"
               href="https://www.facebook.com/faker.tops"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-facebook"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
            <a title="instagram"
               href="https://www.facebook.com/faker.tops"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-instagram"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="reddit"
               href="https://www.reddit.com/user/yelog/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-reddit"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="weibo"
               href="http://weibo.com/u/2307534817"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-weibo"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="jianshu"
               href="https://www.jianshu.com/u/ff56736de7cf"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-jianshu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/people/jaytp/activities"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="oschina"
               href="https://my.oschina.net/yelog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-oschina"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="email"
               href="mailto:417860634@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=417860634&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="kugou"
               href="https://www.kugou.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-kugou"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="neteasemusic"
               href="https://music.163.com/#/user/home?id=88151013"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-neteasemusic"></use>
                    </svg>
                
            </a>
        
    
</div>



    <a class="more-menus">æ›´å¤šèœå•</a>


<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(22)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="åç«¯">
                        
                        åç«¯
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="æ•°æ®åº“">
                        
                        æ•°æ®åº“
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="è¿ç»´">
                        
                        è¿ç»´
                        <small>(8)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="å¼€æºé¡¹ç›®">
                        
                        å¼€æºé¡¹ç›®
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="åŒºå—é“¾">
                        
                        åŒºå—é“¾
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="å¾®æœåŠ¡">
                        
                        å¾®æœåŠ¡
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Golang">
                        <i class="fold iconfont icon-right"></i>
                        
                        Golang
                        <small>(5)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="Golang<--->è¯»ä¹¦ç¬”è®°">
                                        
                                        è¯»ä¹¦ç¬”è®°
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="Golang<--->åŸºç¡€">
                                        
                                        åŸºç¡€
                                        
                                            <small>(4
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
                <a class="dynamic-menu "
                   target="_blank"
                        
                   href="https://github.com/lukaixin0527">github</a>
        
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="22">
<input type="hidden" id="yelog_site_word_count" value="48.2k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.macwk.com/">MacWk</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="æœç´¢ å¿«æ·é”® i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="åˆ‡æ¢åˆ°å¤§çº²è§†å›¾ å¿«æ·é”® w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="è¿”å›"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="å¤§å°å†™æ•æ„Ÿ"></i>
            <i class="iconfont icon-tag" data-title="æ ‡ç­¾"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">å¤§çº²</div>
            <i class="iconfont icon-list" data-title="åˆ‡æ¢åˆ°æ–‡ç« åˆ—è¡¨"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åšå®¢</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å­˜å‚¨è¿‡ç¨‹</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>é˜²ç«å¢™</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åˆ†åŒº</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æœåŠ¡ç›‘æ§</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å¼€æº</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>åŒºå—é“¾</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ•°æ®åº“</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>å¾®æœåŠ¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ¶ˆæ¯é˜Ÿåˆ—</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ­£åˆ™</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Docker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ETH</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ETL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Go</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hexo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JSON Path</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kettle</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>mysql</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Nginx</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Oracle</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RabbitMq</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Spring Cloud Alibaba</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All å¼€æºé¡¹ç›® "
           href="/2099/03/23/2099-03-23-%E4%BC%98%E7%A7%80%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"
           data-tag="å¼€æº"
           data-author="" >
            <span class="post-title" title="ä¼˜ç§€çš„å¼€æºé¡¹ç›®">ä¼˜ç§€çš„å¼€æºé¡¹ç›®</span>
            <span class="post-date" title="2099-03-23 00:00:00">2099/03/23</span>
        </a>
        
        
        <a  class="All Golang åŸºç¡€ "
           href="/2099/03/23/Go-%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/"
           data-tag="Go"
           data-author="" >
            <span class="post-title" title="Go å­¦ä¹ èµ„æ–™">Go å­¦ä¹ èµ„æ–™</span>
            <span class="post-date" title="2099-03-23 00:00:00">2099/03/23</span>
        </a>
        
        
        <a  class="All æ•°æ®åº“ "
           href="/2022/03/23/2022-03-23-MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%8C%E8%AE%B0%E5%BD%95%E6%AF%8F%E4%B8%AA%E8%A1%A8%E6%95%B0%E6%8D%AE%E5%A4%A7%E5%B0%8F/"
           data-tag="å­˜å‚¨è¿‡ç¨‹"
           data-author="" >
            <span class="post-title" title="MySQLå­˜å‚¨è¿‡ç¨‹ï¼Œè®°å½•æ¯ä¸ªè¡¨æ•°æ®å¤§å°">MySQLå­˜å‚¨è¿‡ç¨‹ï¼Œè®°å½•æ¯ä¸ªè¡¨æ•°æ®å¤§å°</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All Golang è¯»ä¹¦ç¬”è®° "
           href="/2022/03/23/2022-03-23-%E3%80%8AGo%E8%AF%AD%E8%A8%80%E5%9C%A3%E7%BB%8F%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"
           data-tag="Go"
           data-author="" >
            <span class="post-title" title="ã€ŠGoè¯­è¨€åœ£ç»ã€‹è¯»ä¹¦ç¬”è®°">ã€ŠGoè¯­è¨€åœ£ç»ã€‹è¯»ä¹¦ç¬”è®°</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All åŒºå—é“¾ "
           href="/2022/03/23/2022-03-23-%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B5%84%E6%96%99/"
           data-tag="åŒºå—é“¾"
           data-author="" >
            <span class="post-title" title="åŒºå—é“¾èµ„æ–™">åŒºå—é“¾èµ„æ–™</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All åŒºå—é“¾ "
           href="/2022/03/23/2022-03-23-%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B5%84%E6%96%99ETH/"
           data-tag="ETH"
           data-author="" >
            <span class="post-title" title="ä»¥å¤ªåŠ">ä»¥å¤ªåŠ</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Docker%E5%AE%B9%E5%99%A8/"
           data-tag="Docker"
           data-author="" >
            <span class="post-title" title="Dockerå®¹å™¨">Dockerå®¹å™¨</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All Golang åŸºç¡€ "
           href="/2022/03/23/Go-03%E3%80%81%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E6%88%98/"
           data-tag="Go"
           data-author="" >
            <span class="post-title" title="Go 03ã€å…¥é—¨åˆ°å®æˆ˜">Go 03ã€å…¥é—¨åˆ°å®æˆ˜</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All Golang åŸºç¡€ "
           href="/2022/03/23/Go%E8%8F%9C%E9%B8%9F%E6%95%99%E7%A8%8B/"
           data-tag="Go"
           data-author="" >
            <span class="post-title" title="Go 02ã€åŸºç¡€è¯­æ³•">Go 02ã€åŸºç¡€è¯­æ³•</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All Golang åŸºç¡€ "
           href="/2022/03/23/Go%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"
           data-tag="Go"
           data-author="" >
            <span class="post-title" title="Go 01ã€è¯­è¨€ç¯å¢ƒå®‰è£…">Go 01ã€è¯­è¨€ç¯å¢ƒå®‰è£…</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All åç«¯ "
           href="/2022/03/23/Kettle-%E6%A1%88%E4%BE%8B%E3%80%90%E5%8F%91%E9%80%81Http%E8%AF%B7%E6%B1%82%E3%80%91/"
           data-tag="ETL,Kettle,JSON Path"
           data-author="" >
            <span class="post-title" title="Kettle">Kettle</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Linux%E7%BC%96%E5%86%99%E9%87%8D%E5%90%AFJar%E7%A8%8B%E5%BA%8F%E8%84%9A%E6%9C%AC/"
           data-tag="æœåŠ¡ç›‘æ§"
           data-author="" >
            <span class="post-title" title="Linuxç¼–å†™é‡å¯Jarç¨‹åºè„šæœ¬ã€å®šæ—¶æ¸…é™¤æ—¥å¿—">Linuxç¼–å†™é‡å¯Jarç¨‹åºè„šæœ¬ã€å®šæ—¶æ¸…é™¤æ—¥å¿—</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Linux%E5%AE%89%E8%A3%85%E5%A4%9A%E4%B8%AAMysql8/"
           data-tag="mysql"
           data-author="" >
            <span class="post-title" title="Linuxå®‰è£…å¤šä¸ªMysql8">Linuxå®‰è£…å¤šä¸ªMysql8</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Liunx%E5%BC%80%E5%90%AF%E9%98%B2%E7%81%AB%E5%A2%99%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3/"
           data-tag="é˜²ç«å¢™"
           data-author="" >
            <span class="post-title" title="Liunxé˜²ç«å¢™">Liunxé˜²ç«å¢™</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Nginx+Keepalived-%E9%AB%98%E5%8F%AF%E7%94%A8/"
           data-tag="Nginx"
           data-author="" >
            <span class="post-title" title="Nginx+Keepalived é«˜å¯ç”¨">Nginx+Keepalived é«˜å¯ç”¨</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/RabbitMq%E5%AE%89%E8%A3%85/"
           data-tag="æ¶ˆæ¯é˜Ÿåˆ—,RabbitMq"
           data-author="" >
            <span class="post-title" title="RabbitMqå®‰è£…">RabbitMqå®‰è£…</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/Prometheus+Grafana%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/"
           data-tag="æœåŠ¡ç›‘æ§"
           data-author="" >
            <span class="post-title" title="Prometheus+Grafanaæ­å»ºæœåŠ¡ç›‘æ§">Prometheus+Grafanaæ­å»ºæœåŠ¡ç›‘æ§</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All å¾®æœåŠ¡ "
           href="/2022/03/23/Spring%20Cloud%20Alibaba/"
           data-tag="Spring Cloud Alibaba"
           data-author="" >
            <span class="post-title" title="Spring Cloud Alibaba">Spring Cloud Alibaba</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All å¾®æœåŠ¡ "
           href="/2022/03/23/SpringCloud-%E5%85%A5%E9%97%A8/"
           data-tag="å¾®æœåŠ¡"
           data-author="" >
            <span class="post-title" title="SpringCloud-å…¥é—¨">SpringCloud-å…¥é—¨</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All æ•°æ®åº“ "
           href="/2022/03/23/%E5%88%A9%E7%94%A8Oracle%E5%88%86%E5%8C%BA%E4%BC%98%E5%8C%96%E6%9F%A5%E8%AF%A2/"
           data-tag="æ•°æ®åº“,Oracle,åˆ†åŒº"
           data-author="" >
            <span class="post-title" title="åˆ©ç”¨Oracleåˆ†åŒºä¼˜åŒ–æŸ¥è¯¢">åˆ©ç”¨Oracleåˆ†åŒºä¼˜åŒ–æŸ¥è¯¢</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All åç«¯ "
           href="/2022/03/23/%E6%AD%A3%E5%88%99%E6%A0%A1%E9%AA%8C/"
           data-tag="hexo,æ­£åˆ™"
           data-author="" >
            <span class="post-title" title="æ­£åˆ™æ ¡éªŒ">æ­£åˆ™æ ¡éªŒ</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        
        <a  class="All è¿ç»´ "
           href="/2022/03/23/%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2/"
           data-tag="hexo,åšå®¢"
           data-author="" >
            <span class="post-title" title="æ­å»ºHexoåšå®¢">æ­å»ºHexoåšå®¢</span>
            <span class="post-date" title="2022-03-23 15:13:47">2022/03/23</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Prometheus+GrafanaæœåŠ¡ç›‘æ§" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Prometheus+Grafanaæ­å»ºæœåŠ¡ç›‘æ§</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="è¿ç»´">è¿ç»´</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color5">æœåŠ¡ç›‘æ§</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2022-09-02 15:12:28'>2022-03-23 15:13</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="è·³è½¬è‡³è¯„è®ºåŒº">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B"><span class="toc-text">ä¸€ã€ç®€ä»‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Prometheus%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">äºŒã€Prometheusçš„ç‰¹ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%98%93%E4%BA%8E%E7%AE%A1%E7%90%86"><span class="toc-text">1ã€æ˜“äºç®¡ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%86%85%E9%83%A8%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81"><span class="toc-text">2ã€ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-text">3ã€å¼ºå¤§çš„æ•°æ®æ¨¡å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80-PromQL"><span class="toc-text">4ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ PromQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E9%AB%98%E6%95%88"><span class="toc-text">5ã€é«˜æ•ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E5%8F%AF%E6%89%A9%E5%B1%95"><span class="toc-text">6ã€å¯æ‰©å±•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E6%98%93%E4%BA%8E%E9%9B%86%E6%88%90"><span class="toc-text">7ã€æ˜“äºé›†æˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">8ã€å¯è§†åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E5%BC%80%E6%94%BE%E6%80%A7"><span class="toc-text">9ã€å¼€æ”¾æ€§</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81Prometheus-%E7%9A%84%E6%9E%B6%E6%9E%84"><span class="toc-text">ä¸‰ã€Prometheus çš„æ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%AD%98%E5%82%A8%E8%AE%A1%E7%AE%97%E5%B1%82"><span class="toc-text">1ã€å­˜å‚¨è®¡ç®—å±‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E9%87%87%E9%9B%86%E5%B1%82"><span class="toc-text">2ã€é‡‡é›†å±‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-text">3ã€åº”ç”¨å±‚</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Prometheus-%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-text">å››ã€Prometheus çš„å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81prometheus%E5%AE%89%E8%A3%85"><span class="toc-text">1ã€prometheuså®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81node-exporter%E5%AE%89%E8%A3%85"><span class="toc-text">2ã€node_exporterå®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81prometheus%E5%90%AF%E5%8A%A8"><span class="toc-text">3ã€prometheuså¯åŠ¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81pushgateway-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8"><span class="toc-text">4ã€pushgateway å®‰è£…ä¸å¯åŠ¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81PromQL%E4%BB%8B%E7%BB%8D"><span class="toc-text">äº”ã€PromQLä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-text">1ã€åŸºæœ¬ç”¨æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-text">æŸ¥è¯¢æ—¶é—´åºåˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="toc-text">èŒƒå›´æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E4%BD%8D%E7%A7%BB%E6%93%8D%E4%BD%9C"><span class="toc-text">æ—¶é—´ä½ç§»æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-text">ä½¿ç”¨èšåˆæ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E9%87%8F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">æ ‡é‡å’Œå­—ç¬¦ä¸²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E6%B3%95%E7%9A%84-PromQL-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">åˆæ³•çš„ PromQL è¡¨è¾¾å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PromQL-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-text">PromQL æ“ä½œç¬¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">ä½¿ç”¨é›†åˆè¿ç®—ç¬¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">æ“ä½œç¬¦ä¼˜å…ˆçº§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PromQL-%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-text">PromQL èšåˆæ“ä½œ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81Prometheus-%E5%92%8C-Grafana-%E9%9B%86%E6%88%90"><span class="toc-text">å…­ã€Prometheus å’Œ Grafana é›†æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85"><span class="toc-text">1ã€å®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E4%BD%BF%E7%94%A8"><span class="toc-text">2ã€å¯åŠ¨æœåŠ¡ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">3ã€é…ç½®æ•°æ®æº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA%E4%BB%AA%E8%A1%A8%E7%9B%98-Dashboard"><span class="toc-text">4ã€æ‰‹åŠ¨åˆ›å»ºä»ªè¡¨ç›˜ Dashboard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81-Dashboard-%E6%A8%A1%E6%9D%BF"><span class="toc-text">5ã€ Dashboard æ¨¡æ¿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-text">6ã€é…ç½®å…å¯†ç™»å½•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%AE%9E%E6%88%98"><span class="toc-text">ä¸ƒã€å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E7%9B%91%E6%8E%A7RabbitMq"><span class="toc-text">1ã€ç›‘æ§RabbitMq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E7%9B%91%E6%8E%A7liunx%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">2ã€ç›‘æ§liunxæœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%9B%91%E6%8E%A7mysql%E6%9C%8D%E5%8A%A1"><span class="toc-text">3ã€ç›‘æ§mysqlæœåŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E7%9B%91%E6%8E%A7springboot%E6%9C%8D%E5%8A%A1"><span class="toc-text">4ã€ç›‘æ§springbootæœåŠ¡</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a><strong>ä¸€ã€ç®€ä»‹</strong></h1><p> Prometheuså¯ä»¥ç›‘æ§æœåŠ¡å™¨æƒ…å†µï¼Œä¹Ÿå¯ä»¥ç›‘æ§åº”ç”¨æœåŠ¡å†…éƒ¨æƒ…å†µã€‚ä¸»è¦é…åˆGrafanaä½¿ç”¨ï¼ŒPrometheusè´Ÿè´£é‡‡é›†æ•°æ®æ¨é€åˆ°Grafana,Grafanaè´Ÿè½½å¯è§†åŒ–å±•ç¤ºã€‚</p>
<p>å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://prometheus.io/">https://prometheus.io/</a></p>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://prometheus.io/download/">https://prometheus.io/download/</a></p>
<h1 id="äºŒã€Prometheusçš„ç‰¹ç‚¹"><a href="#äºŒã€Prometheusçš„ç‰¹ç‚¹" class="headerlink" title="äºŒã€Prometheusçš„ç‰¹ç‚¹"></a><strong>äºŒã€Prometheusçš„ç‰¹ç‚¹</strong></h1><p>Prometheus æ˜¯ä¸€ä¸ªå¼€æºçš„å®Œæ•´ç›‘æ§è§£å†³æ–¹æ¡ˆï¼Œå…¶å¯¹ä¼ ç»Ÿç›‘æ§ç³»ç»Ÿçš„æµ‹è¯•å’Œå‘Šè­¦æ¨¡å‹è¿›è¡Œäº†å½»åº•çš„é¢ è¦†ï¼Œå½¢æˆäº†åŸºäºä¸­å¤®åŒ–çš„è§„åˆ™è®¡ç®—ã€ç»Ÿä¸€åˆ†æå’Œå‘Šè­¦çš„æ–°æ¨¡å‹ã€‚ ç›¸æ¯”äºä¼ ç»Ÿç›‘æ§ç³»ç»Ÿï¼ŒPrometheus å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p>
<h2 id="1ã€æ˜“äºç®¡ç†"><a href="#1ã€æ˜“äºç®¡ç†" class="headerlink" title="1ã€æ˜“äºç®¡ç†"></a><strong>1ã€æ˜“äºç®¡ç†</strong></h2><p>Prometheus æ ¸å¿ƒéƒ¨åˆ†åªæœ‰ä¸€ä¸ªå•ç‹¬çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸å­˜åœ¨ä»»ä½•çš„ç¬¬ä¸‰æ–¹ä¾èµ–(æ•°æ®åº“ï¼Œç¼“å­˜ç­‰ç­‰)ã€‚å”¯ä¸€éœ€è¦çš„å°±æ˜¯æœ¬åœ°ç£ç›˜ï¼Œå› æ­¤ä¸ä¼šæœ‰æ½œåœ¨çº§è”æ•…éšœçš„é£é™©ã€‚</p>
<p>Prometheus åŸºäº Pull æ¨¡å‹çš„æ¶æ„æ–¹å¼ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ï¼ˆæœ¬åœ°ç”µè„‘ï¼Œå¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•ç¯å¢ƒï¼‰æ­å»ºæˆ‘ä»¬çš„ç›‘æ§ç³»ç»Ÿã€‚</p>
<p>å¯¹äºä¸€äº›å¤æ‚çš„æƒ…å†µï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Prometheus æœåŠ¡å‘ç°(Service Discovery)çš„èƒ½åŠ›åŠ¨æ€ç®¡ç†ç›‘æ§ç›®æ ‡ã€‚</p>
<h2 id="2ã€ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€"><a href="#2ã€ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€" class="headerlink" title="2ã€ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€"></a><strong>2ã€ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€</strong></h2><p>Pometheus é¼“åŠ±ç”¨æˆ·ç›‘æ§æœåŠ¡çš„å†…éƒ¨çŠ¶æ€ï¼ŒåŸºäºPrometheus ä¸°å¯Œçš„ Client åº“ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾çš„åœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ å¯¹Prometheus çš„æ”¯æŒï¼Œä»è€Œè®©ç”¨æˆ·å¯ä»¥è·å–æœåŠ¡å’Œåº”ç”¨å†…éƒ¨çœŸæ­£çš„è¿è¡ŒçŠ¶æ€ã€‚</p>
<h2 id="3ã€å¼ºå¤§çš„æ•°æ®æ¨¡å‹"><a href="#3ã€å¼ºå¤§çš„æ•°æ®æ¨¡å‹" class="headerlink" title="3ã€å¼ºå¤§çš„æ•°æ®æ¨¡å‹"></a><strong>3ã€å¼ºå¤§çš„æ•°æ®æ¨¡å‹</strong></h2><p>æ‰€æœ‰é‡‡é›†çš„ç›‘æ§æ•°æ®å‡ä»¥æŒ‡æ ‡(metric)çš„å½¢å¼ä¿å­˜åœ¨<strong>å†…ç½®çš„æ—¶é—´åºåˆ—æ•°æ®åº“</strong>å½“ä¸­ï¼ˆTSDBï¼ŒTime Series DBï¼‰ã€‚æ‰€æœ‰çš„æ ·æœ¬é™¤äº†åŸºæœ¬çš„æŒ‡æ ‡åç§°ä»¥å¤–ï¼Œè¿˜åŒ…å«ä¸€ç»„ç”¨äºæè¿°è¯¥æ ·æœ¬ç‰¹å¾çš„æ ‡ç­¾ã€‚</p>
<pre><code class="java">http_request_status&#123;
    code=&#39;200&#39;,
    content_path=&#39;/api/path&#39;,
    environment=&#39;produment&#39;
&#125; =&gt;
[value1@timestamp1,value2@timestamp2...]

http_request_status&#123; # æŒ‡æ ‡åç§°
    code=&#39;200&#39;, # ç»´åº¦çš„æ ‡ç­¾
    content_path=&#39;/api/path2&#39;,
    environment=&#39;produment&#39;
&#125; =&gt;
[value1@timestamp1,value2@timestamp2...] # å­˜å‚¨çš„æ ·æœ¬å€¼
</code></pre>
<p>æ¯ä¸€æ¡æ—¶é—´åºåˆ—ç”±**æŒ‡æ ‡åç§°(Metrics Name)<strong>ä»¥åŠä¸€ç»„</strong>æ ‡ç­¾(Labels)**å”¯ä¸€æ ‡è¯†ã€‚æ¯æ¡æ—¶é—´åºåˆ—æŒ‰ç…§æ—¶é—´çš„å…ˆåé¡ºåºå­˜å‚¨ä¸€ç³»åˆ—çš„æ ·æœ¬å€¼ã€‚</p>
<pre><code class="java">http_request_statusï¼šæŒ‡æ ‡åç§°(Metrics Name)

&#123;code=â€˜200â€™,content_path=â€™/api/pathâ€™,environment=â€˜produmentâ€™&#125;ï¼šè¡¨ç¤ºç»´åº¦çš„æ ‡ç­¾ï¼ŒåŸºäºè¿™äº› Labels æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å¯¹ç›‘æ§æ•°æ®è¿›è¡Œèšåˆï¼Œè¿‡æ»¤ï¼Œè£å‰ªã€‚

[value1@timestamp1,value2@timestamp2â€¦]ï¼šæŒ‰ç…§æ—¶é—´çš„å…ˆåé¡ºåºå­˜å‚¨çš„æ ·æœ¬å€¼ã€‚
</code></pre>
<h2 id="4ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€-PromQL"><a href="#4ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€-PromQL" class="headerlink" title="4ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ PromQL"></a><strong>4ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ PromQL</strong></h2><p>Prometheus å†…ç½®äº†ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®æŸ¥è¯¢è¯­è¨€ PromQLã€‚ é€šè¿‡ PromQL å¯ä»¥å®ç°å¯¹ç›‘æ§æ•°æ®çš„æŸ¥è¯¢ã€èšåˆã€‚åŒæ—¶ PromQL ä¹Ÿè¢«åº”ç”¨äºæ•°æ®å¯è§†åŒ–(å¦‚ Grafana)ä»¥åŠå‘Šè­¦å½“ä¸­ã€‚</p>
<p>é€šè¿‡PromQL å¯ä»¥è½»æ¾å›ç­”ç±»ä¼¼äºä»¥ä¸‹é—®é¢˜ï¼š</p>
<pre><code>åœ¨è¿‡å»ä¸€æ®µæ—¶é—´ä¸­ 95%åº”ç”¨å»¶è¿Ÿæ—¶é—´çš„åˆ†å¸ƒèŒƒå›´ï¼Ÿ

é¢„æµ‹åœ¨ 4 å°æ—¶åï¼Œç£ç›˜ç©ºé—´å ç”¨å¤§è‡´ä¼šæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ

CPU å ç”¨ç‡å‰ 5 ä½çš„æœåŠ¡æœ‰å“ªäº›ï¼Ÿ(è¿‡æ»¤)
</code></pre>
<h2 id="5ã€é«˜æ•ˆ"><a href="#5ã€é«˜æ•ˆ" class="headerlink" title="5ã€é«˜æ•ˆ"></a><strong>5ã€é«˜æ•ˆ</strong></h2><p>å¯¹äºç›‘æ§ç³»ç»Ÿè€Œè¨€ï¼Œå¤§é‡çš„ç›‘æ§ä»»åŠ¡å¿…ç„¶å¯¼è‡´æœ‰å¤§é‡çš„æ•°æ®äº§ç”Ÿã€‚è€ŒPrometheus å¯ä»¥é«˜æ•ˆåœ°å¤„ç†è¿™äº›æ•°æ®ï¼Œå¯¹äºå•ä¸€Prometheus Server å®ä¾‹è€Œè¨€å®ƒå¯ä»¥å¤„ç†ï¼š</p>
<pre><code>æ•°ä»¥ç™¾ä¸‡çš„ç›‘æ§æŒ‡æ ‡
æ¯ç§’å¤„ç†æ•°åä¸‡çš„æ•°æ®ç‚¹
</code></pre>
<h2 id="6ã€å¯æ‰©å±•"><a href="#6ã€å¯æ‰©å±•" class="headerlink" title="6ã€å¯æ‰©å±•"></a><strong>6ã€å¯æ‰©å±•</strong></h2><p>å¯ä»¥åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒã€æ¯ä¸ªå›¢é˜Ÿè¿è¡Œç‹¬ç«‹çš„Prometheus Sevrerã€‚Prometheus å¯¹äºè”é‚¦é›†ç¾¤çš„æ”¯æŒï¼Œå¯ä»¥è®©å¤šä¸ª Prometheus å®ä¾‹äº§ç”Ÿä¸€ä¸ªé€»è¾‘é›†ç¾¤ï¼Œå½“å•å®ä¾‹ Prometheus Server å¤„ç†çš„ä»»åŠ¡é‡è¿‡å¤§æ—¶ï¼Œé€šè¿‡ä½¿ç”¨åŠŸèƒ½åˆ†åŒº(sharding)+è”é‚¦é›†ç¾¤(federation)å¯ä»¥å¯¹å…¶è¿›è¡Œæ‰©å±•ã€‚</p>
<h2 id="7ã€æ˜“äºé›†æˆ"><a href="#7ã€æ˜“äºé›†æˆ" class="headerlink" title="7ã€æ˜“äºé›†æˆ"></a><strong>7ã€æ˜“äºé›†æˆ</strong></h2><p>ä½¿ç”¨Prometheus å¯ä»¥å¿«é€Ÿæ­å»ºç›‘æ§æœåŠ¡ï¼Œå¹¶ä¸”å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œé›†æˆã€‚ç›®å‰æ”¯æŒï¼šJavaï¼ŒJMXï¼ŒPythonï¼ŒGoï¼ŒRubyï¼Œ.Netï¼ŒNode.js ç­‰ç­‰è¯­è¨€çš„å®¢æˆ·ç«¯ SDKï¼ŒåŸºäºè¿™äº› SDK å¯ä»¥å¿«é€Ÿè®©åº”ç”¨ç¨‹åºçº³å…¥åˆ° Prometheus çš„ç›‘æ§å½“ä¸­ï¼Œæˆ–è€…å¼€å‘è‡ªå·±çš„ç›‘æ§æ•°æ®æ”¶é›†ç¨‹åºã€‚</p>
<p>åŒæ—¶è¿™äº›å®¢æˆ·ç«¯æ”¶é›†çš„ç›‘æ§æ•°æ®ï¼Œä¸ä»…ä»…æ”¯æŒ Prometheusï¼Œè¿˜èƒ½æ”¯æŒ Graphite è¿™äº›å…¶ä»–çš„ç›‘æ§å·¥å…·ã€‚</p>
<p>åŒæ—¶Prometheus è¿˜æ”¯æŒä¸å…¶ä»–çš„ç›‘æ§ç³»ç»Ÿè¿›è¡Œé›†æˆï¼šGraphiteï¼ŒStatsdï¼ŒCollectedï¼Œ Scollectorï¼Œ muiniï¼Œ Nagios ç­‰ã€‚ Prometheus ç¤¾åŒºè¿˜æä¾›äº†å¤§é‡ç¬¬ä¸‰æ–¹å®ç°çš„ç›‘æ§æ•°æ®é‡‡é›†æ”¯æŒï¼šJMXï¼ŒCloudWatchï¼ŒEC2ï¼ŒMySQLï¼ŒPostgresSQLï¼ŒHaskellï¼ŒBashï¼ŒSNMPï¼Œ Consulï¼ŒHaproxyï¼ŒMesosï¼ŒBindï¼ŒCouchDBï¼ŒDjangoï¼ŒMemcachedï¼ŒRabbitMQï¼ŒRedisï¼ŒRethinkDBï¼ŒRsyslog ç­‰ç­‰ã€‚</p>
<h2 id="8ã€å¯è§†åŒ–"><a href="#8ã€å¯è§†åŒ–" class="headerlink" title="8ã€å¯è§†åŒ–"></a><strong>8ã€å¯è§†åŒ–</strong></h2><p>Prometheus Server ä¸­è‡ªå¸¦çš„ <code>Prometheus UI</code>ï¼Œå¯ä»¥æ–¹ä¾¿åœ°ç›´æ¥å¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸”æ”¯æŒç›´æ¥ä»¥å›¾å½¢åŒ–çš„å½¢å¼å±•ç¤ºæ•°æ®ã€‚åŒæ—¶ Prometheus è¿˜æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„åŸºäºRuby On Rails çš„ Dashboard è§£å†³æ–¹æ¡ˆ Promdashã€‚</p>
<p>æœ€æ–°çš„ <code>Grafana</code> å¯è§†åŒ–å·¥å…·ä¹Ÿå·²ç»æä¾›äº†å®Œæ•´çš„Prometheus æ”¯æŒï¼ŒåŸºäº Grafana å¯ä»¥åˆ›å»ºæ›´åŠ ç²¾ç¾çš„ç›‘æ§å›¾æ ‡ã€‚</p>
<p>åŸºäºPrometheus æä¾›çš„API è¿˜å¯ä»¥å®ç°<code>è‡ªå·±çš„ç›‘æ§å¯è§†åŒ–UI</code>ã€‚</p>
<h2 id="9ã€å¼€æ”¾æ€§"><a href="#9ã€å¼€æ”¾æ€§" class="headerlink" title="9ã€å¼€æ”¾æ€§"></a><strong>9ã€å¼€æ”¾æ€§</strong></h2><p>é€šå¸¸æ¥è¯´å½“æˆ‘ä»¬éœ€è¦ç›‘æ§ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œä¸€èˆ¬éœ€è¦è¯¥åº”ç”¨ç¨‹åºæä¾›å¯¹ç›¸åº”ç›‘æ§ç³»ç»Ÿåè®®çš„æ”¯æŒï¼Œå› æ­¤åº”ç”¨ç¨‹åºä¼šä¸æ‰€é€‰æ‹©çš„ç›‘æ§ç³»ç»Ÿè¿›è¡Œç»‘å®šã€‚ä¸ºäº†å‡å°‘è¿™ç§ç»‘å®šæ‰€å¸¦æ¥çš„é™åˆ¶ï¼Œå¯¹äºå†³ç­–è€…è€Œè¨€è¦ä¹ˆä½ å°±ç›´æ¥åœ¨åº”ç”¨ä¸­é›†æˆè¯¥ç›‘æ§ç³»ç»Ÿçš„æ”¯æŒï¼Œè¦ä¹ˆå°±åœ¨å¤–éƒ¨åˆ›å»ºå•ç‹¬çš„æœåŠ¡æ¥é€‚é…ä¸åŒçš„ç›‘æ§ç³»ç»Ÿã€‚</p>
<p>è€Œå¯¹äº Prometheus æ¥è¯´ï¼Œä½¿ç”¨ Prometheus çš„ client library çš„è¾“å‡ºæ ¼å¼ä¸æ­¢æ”¯æŒPrometheus çš„æ ¼å¼åŒ–æ•°æ®ï¼Œä¹Ÿå¯ä»¥è¾“å‡ºæ”¯æŒå…¶å®ƒç›‘æ§ç³»ç»Ÿçš„æ ¼å¼åŒ–æ•°æ®ï¼Œæ¯”å¦‚ Graphiteã€‚å› æ­¤ä½ ç”šè‡³å¯ä»¥åœ¨ä¸ä½¿ç”¨Prometheus çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ Prometheus çš„ client library æ¥è®©ä½ çš„åº”ç”¨ç¨‹åºæ”¯æŒç›‘æ§æ•°æ®é‡‡é›†ã€‚</p>
<h1 id="ä¸‰ã€Prometheus-çš„æ¶æ„"><a href="#ä¸‰ã€Prometheus-çš„æ¶æ„" class="headerlink" title="ä¸‰ã€Prometheus çš„æ¶æ„"></a><strong>ä¸‰ã€Prometheus çš„æ¶æ„</strong></h1><p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/d6476d493d8232e51931cdae138f05f4.png" alt="img"></p>
<p>prometheus è´Ÿè´£ä» <code>pushgateway</code> å’Œ <code>job</code> ä¸­é‡‡é›†æ•°æ®ï¼Œ å­˜å‚¨åˆ°åç«¯ <code>Storatge</code> ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>PromQL</code> è¿›è¡ŒæŸ¥è¯¢ï¼Œ æ¨é€ alerts ä¿¡æ¯åˆ° <code>AlertManager</code>ã€‚ AlertManager æ ¹æ®ä¸åŒçš„è·¯ç”±è§„åˆ™è¿›è¡ŒæŠ¥è­¦é€šçŸ¥</p>
<h2 id="1ã€å­˜å‚¨è®¡ç®—å±‚"><a href="#1ã€å­˜å‚¨è®¡ç®—å±‚" class="headerlink" title="1ã€å­˜å‚¨è®¡ç®—å±‚"></a><strong>1ã€å­˜å‚¨è®¡ç®—å±‚</strong></h2><pre><code>Prometheus Serverï¼Œé‡Œé¢åŒ…å«äº†å­˜å‚¨å¼•æ“å’Œè®¡ç®—å¼•æ“ã€‚
Retrieval ç»„ä»¶ä¸ºå–æ•°ç»„ä»¶ï¼Œå®ƒä¼šä¸»åŠ¨ä» PushGateway æˆ–è€… Exporter æ‹‰å–æŒ‡æ ‡æ•°æ®ã€‚
Service discoveryï¼Œå¯ä»¥åŠ¨æ€å‘ç°è¦ç›‘æ§çš„ç›®æ ‡ã€‚
TSDBï¼Œæ•°æ®æ ¸å¿ƒå­˜å‚¨ä¸æŸ¥è¯¢ã€‚
HTTP serverï¼Œå¯¹å¤–æä¾› HTTP æœåŠ¡ã€‚
</code></pre>
<h2 id="2ã€é‡‡é›†å±‚"><a href="#2ã€é‡‡é›†å±‚" class="headerlink" title="2ã€é‡‡é›†å±‚"></a><strong>2ã€é‡‡é›†å±‚</strong></h2><pre><code>é‡‡é›†å±‚åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„ä½œä¸šï¼Œè¿˜æœ‰ä¸€ç±»æ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„ä½œä¸šã€‚
çŸ­ä½œä¸šï¼šç›´æ¥é€šè¿‡ APIï¼Œåœ¨é€€å‡ºæ—¶é—´æŒ‡æ ‡æ¨é€ç»™PushGateway ã€‚(ä¸€èˆ¬æ£€æŸ¥ä¸å›ºå®šçš„æœåŠ¡)
é•¿ä½œä¸šï¼šRetrieval ç»„ä»¶ç›´æ¥ä» Job æˆ–è€… Exporter æ‹‰å–æ•°æ®ã€‚(ä¸€èˆ¬æ£€æŸ¥å›ºå®šæœåŠ¡å™¨çš„æœåŠ¡)
</code></pre>
<h2 id="3ã€åº”ç”¨å±‚"><a href="#3ã€åº”ç”¨å±‚" class="headerlink" title="3ã€åº”ç”¨å±‚"></a><strong>3ã€åº”ç”¨å±‚</strong></h2><p>åº”ç”¨å±‚ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯AlertManagerï¼ˆæŠ¥è­¦ï¼‰ï¼Œå¦ä¸€ç§æ˜¯æ•°æ®å¯è§†åŒ–ã€‚</p>
<pre><code>AlertManager
    å¯¹æ¥Pagerdutyï¼Œæ˜¯ä¸€å¥—ä»˜è´¹çš„ç›‘æ§æŠ¥è­¦ç³»ç»Ÿã€‚å¯å®ç°çŸ­ä¿¡æŠ¥è­¦ã€5 åˆ†é’Ÿæ— äºº ack æ‰“ç”µè¯é€šçŸ¥ã€ä»ç„¶æ— äºº ackï¼Œé€šçŸ¥å€¼ç­äººå‘˜ Managerâ€¦Emialï¼Œå‘é€é‚®ä»¶â€¦ 
æ•°æ®å¯è§†åŒ–
    Prometheus build-in WebUIã€Grafanaã€å…¶ä»–åŸºäºAPI å¼€å‘çš„å®¢æˆ·ç«¯
</code></pre>
<h1 id="å››ã€Prometheus-çš„å®‰è£…"><a href="#å››ã€Prometheus-çš„å®‰è£…" class="headerlink" title="å››ã€Prometheus çš„å®‰è£…"></a>å››ã€Prometheus çš„å®‰è£…</h1><p>å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://prometheus.io/">https://prometheus.io/</a></p>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://prometheus.io/download/">https://prometheus.io/download/</a></p>
<h2 id="1ã€prometheuså®‰è£…"><a href="#1ã€prometheuså®‰è£…" class="headerlink" title="1ã€prometheuså®‰è£…"></a>1ã€prometheuså®‰è£…</h2><pre><code>1ã€ä¸Šä¼  prometheus-2.29.1.linux-amd64.tar.gz
2ã€tar  -zxvf  prometheus-2.29.1.linux-amd64.tar.gz -C /opt/module
3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶prometheus.yml
</code></pre>
<pre><code class="yml"># my global config
global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  # scrape_timeout is set to the global default (10s).

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093

# Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.
rule_files:
  # - &quot;first_rules.yml&quot;
  # - &quot;second_rules.yml&quot;

# A scrape configuration containing exactly one endpoint to scrape:
# Here it&#39;s Prometheus itself.
scrape_configs:
  # The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.
  - job_name: &quot;prometheus&quot;

    # metrics_path defaults to &#39;/metrics&#39;
    # scheme defaults to &#39;http&#39;.

    static_configs:
      - targets: [&quot;127.0.0.1:9090&quot;]
    
# æ·»åŠ  PushGateway ç›‘æ§é…ç½®
  - job_name: &#39;pushgateway&#39;
    static_configs:
    - targets: [&#39;127.0.0.1:9091&#39;]
      labels:
        instance: pushgateway
        
# æ·»åŠ  Node Exporter ç›‘æ§é…ç½®
  - job_name: &#39;node exporter&#39;
    static_configs:
    - targets: [&#39;127.0.0.1:9100&#39;]
</code></pre>
<h2 id="2ã€node-exporterå®‰è£…"><a href="#2ã€node-exporterå®‰è£…" class="headerlink" title="2ã€node_exporterå®‰è£…"></a>2ã€node_exporterå®‰è£…</h2><pre><code class="java">1ã€ä¸Šä¼  node_exporter-1.2.2.linux-amd64.tar.gz 
2ã€è§£å‹æ–‡ä»¶ tar  -zxvf  node_exporter-1.2.2.linux-amd64.tar.gz  -C  /opt/module
3ã€å¯åŠ¨æœåŠ¡ nohup ./node_exporter &gt; node_exporter.log 2&gt;&amp;1 &amp;
4ã€è®¿é—® IP:9100/metrics å³å¯è·å–æœåŠ¡å™¨å‚æ•°
</code></pre>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615220203001.png" alt="image-20220615220203001"></p>
<h2 id="3ã€prometheuså¯åŠ¨"><a href="#3ã€prometheuså¯åŠ¨" class="headerlink" title="3ã€prometheuså¯åŠ¨"></a>3ã€prometheuså¯åŠ¨</h2><pre><code class="java">1ã€è¿›å…¥prometheusç›®å½•
2ã€å¯åŠ¨æœåŠ¡ nohup ./prometheus --config.file=prometheus.yml &gt;./prometheus.log 2&gt;&amp;1 &amp; åå°å¯åŠ¨
3ã€è®¿é—® IP:9090
</code></pre>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615215434281.png" alt="image-20220615215434281"></p>
<h2 id="4ã€pushgateway-å®‰è£…ä¸å¯åŠ¨"><a href="#4ã€pushgateway-å®‰è£…ä¸å¯åŠ¨" class="headerlink" title="4ã€pushgateway å®‰è£…ä¸å¯åŠ¨"></a>4ã€pushgateway å®‰è£…ä¸å¯åŠ¨</h2><pre><code class="java">1ã€ä¸Šä¼  pushgateway-1.4.3.linux-amd64.tar.gz 
2ã€è§£å‹æ–‡ä»¶ tar  -zxvf  pushgateway-1.4.3.linux-amd64.tar.gz   -C  /opt/module
3ã€å¯åŠ¨æœåŠ¡ nohup ./pushgateway --web.listen-address:9091 &gt;./pushgateway.log 2&gt;&amp;1 &amp;
4ã€è®¿é—® IP:9091/metrics
</code></pre>
<p>è‡³æ­¤ï¼Œæ‰€æœ‰æœåŠ¡å‡å·²å¯åŠ¨</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615221701595.png" alt="image-20220615221701595"></p>
<h1 id="äº”ã€PromQLä»‹ç»"><a href="#äº”ã€PromQLä»‹ç»" class="headerlink" title="äº”ã€PromQLä»‹ç»"></a>äº”ã€PromQLä»‹ç»</h1><p>Prometheus é€šè¿‡æŒ‡æ ‡åç§°ï¼ˆmetrics nameï¼‰ä»¥åŠå¯¹åº”çš„ä¸€ç»„æ ‡ç­¾ï¼ˆlabelsetï¼‰å”¯ä¸€å®šä¹‰ä¸€æ¡æ—¶é—´åºåˆ—ã€‚æŒ‡æ ‡åç§°åæ˜ äº†ç›‘æ§æ ·æœ¬çš„åŸºæœ¬æ ‡è¯†ï¼Œè€Œ label åˆ™åœ¨è¿™ä¸ªåŸºæœ¬ç‰¹å¾ä¸Šä¸ºé‡‡é›†åˆ°çš„æ•°æ®æä¾›äº†å¤šç§ç‰¹å¾ç»´åº¦ã€‚ç”¨æˆ·å¯ä»¥åŸºäºè¿™äº›ç‰¹å¾ç»´åº¦è¿‡æ»¤ï¼Œèšåˆï¼Œç»Ÿè®¡ä»è€Œäº§ç”Ÿæ–°çš„è®¡ç®—åçš„ä¸€æ¡æ—¶é—´åºåˆ—ã€‚</p>
<p>PromQL æ˜¯ Prometheus å†…ç½®çš„æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼Œå…¶æä¾›å¯¹æ—¶é—´åºåˆ—æ•°æ®ä¸°å¯Œçš„æŸ¥è¯¢ï¼Œèšåˆä»¥åŠé€»è¾‘è¿ç®—èƒ½åŠ›çš„æ”¯æŒã€‚å¹¶ä¸”è¢«å¹¿æ³›åº”ç”¨åœ¨Prometheusçš„æ—¥å¸¸åº”ç”¨å½“ä¸­ï¼ŒåŒ…æ‹¬å¯¹æ•°æ®æŸ¥è¯¢ã€å¯è§†åŒ–ã€å‘Šè­¦å¤„ç†å½“ä¸­ã€‚</p>
<p>PromQL æ˜¯Prometheus æ‰€æœ‰åº”ç”¨åœºæ™¯çš„åŸºç¡€</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615224314639.png" alt="image-20220615224314639"></p>
<p>åœ¨é¦–é¡µè¾“å…¥æ¡†å†…ï¼Œè¾“å…¥æŒ‡æ ‡åç§°ï¼Œå³å¯æŸ¥è¯¢ã€‚ä¹Ÿå¯ä»¥ç¼–å†™ç±»ä¼¼sqlè¯­è¨€æ ¼å¼ï¼ŒæŸ¥è¯¢æŒ‡æ ‡æ•°æ®ã€‚</p>
<p>æ‰€æœ‰æŒ‡æ ‡ IP:9090&#x2F;metrics å³å¯æŸ¥è¯¢ã€‚æˆ–è€…ç‚¹å‡»è¾“å…¥æ¡†å³ä¾§æŒ‰é’®</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615224540078.png" alt="image-20220615224540078"></p>
<h2 id="1ã€åŸºæœ¬ç”¨æ³•"><a href="#1ã€åŸºæœ¬ç”¨æ³•" class="headerlink" title="1ã€åŸºæœ¬ç”¨æ³•"></a>1ã€åŸºæœ¬ç”¨æ³•</h2><h3 id="æŸ¥è¯¢æ—¶é—´åºåˆ—"><a href="#æŸ¥è¯¢æ—¶é—´åºåˆ—" class="headerlink" title="æŸ¥è¯¢æ—¶é—´åºåˆ—"></a><strong>æŸ¥è¯¢æ—¶é—´åºåˆ—</strong></h3><p>å½“ Prometheus é€šè¿‡ Exporter é‡‡é›†åˆ°ç›¸åº”çš„ç›‘æ§æŒ‡æ ‡æ ·æœ¬æ•°æ®åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡PromQL å¯¹ç›‘æ§æ ·æœ¬æ•°æ®è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p>å½“æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç›‘æ§æŒ‡æ ‡åç§°æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥æŸ¥è¯¢è¯¥æŒ‡æ ‡ä¸‹çš„æ‰€æœ‰æ—¶é—´åºåˆ—ã€‚å¦‚ï¼š</p>
<pre><code>prometheus_http_requests_total                  
ç­‰åŒäºï¼š 
prometheus_http_requests_total&#123;&#125;     
</code></pre>
<p>è¯¥è¡¨è¾¾å¼ä¼šè¿”å›æŒ‡æ ‡åç§°ä¸º prometheus_http_requests_total çš„æ‰€æœ‰æ—¶é—´åºåˆ—ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;
    code=&quot;200&quot;,
    handler=&quot;alerts&quot;,
    instance=&quot;localhost:9090&quot;,
    job=&quot;prometheus&quot;,
    method=&quot;get&quot;
&#125;= (20889@1518096812.326)

prometheus_http_requests_total&#123;
    code=&quot;200&quot;,
    handler=&quot;graph&quot;,
    instance=&quot;localhost:9090&quot;,
    job=&quot;prometheus&quot;,
    method=&quot;get&quot;
&#125;= (21287@1518096812.326)
</code></pre>
<p>PromQL è¿˜æ”¯æŒç”¨æˆ·æ ¹æ®æ—¶é—´åºåˆ—çš„æ ‡ç­¾åŒ¹é…æ¨¡å¼æ¥å¯¹æ—¶é—´åºåˆ—è¿›è¡Œè¿‡æ»¤ï¼Œç›®å‰ä¸»è¦æ”¯æŒä¸¤ç§åŒ¹é…æ¨¡å¼ï¼šå®Œå…¨åŒ¹é…å’Œæ­£åˆ™åŒ¹é…ã€‚</p>
<p>PromQL æ”¯æŒä½¿ç”¨ &#x3D; å’Œ !&#x3D; ä¸¤ç§å®Œå…¨åŒ¹é…æ¨¡å¼ï¼š</p>
<p>é€šè¿‡ä½¿ç”¨ label&#x3D;value å¯ä»¥é€‰æ‹©é‚£äº›æ ‡ç­¾æ»¡è¶³è¡¨è¾¾å¼å®šä¹‰çš„æ—¶é—´åºåˆ—ï¼›<br>åä¹‹ä½¿ç”¨ label!&#x3D;value åˆ™å¯ä»¥æ ¹æ®æ ‡ç­¾åŒ¹é…æ’é™¤æ—¶é—´åºåˆ—ï¼›</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦æŸ¥è¯¢æ‰€æœ‰ prometheus_http_requests_total æ—¶é—´åºåˆ—ä¸­æ»¡è¶³æ ‡ç­¾ instance ä¸º localhost:9090 çš„æ—¶é—´ åºåˆ—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¡¨è¾¾å¼ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;instance=&quot;localhost:9090&quot;&#125;       
</code></pre>
<p>åä¹‹ä½¿ç”¨ instance!&#x3D;â€œlocalhost:9090â€ åˆ™å¯ä»¥æ’é™¤è¿™äº›æ—¶é—´åºåˆ—ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;instance!=&quot;localhost:9090&quot;&#125;
</code></pre>
<p>PromQL è¿˜å¯ä»¥æ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºåŒ¹é…æ¡ä»¶ï¼Œå¤šä¸ªè¡¨è¾¾å¼ä¹‹é—´ä½¿ç”¨ | è¿›è¡Œåˆ†ç¦»ï¼š</p>
<p>ä½¿ç”¨ label&#x3D;<del>regx è¡¨ç¤ºé€‰æ‹©é‚£äº›æ ‡ç­¾ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„æ—¶é—´åºåˆ—ï¼›<br>åä¹‹ä½¿ç”¨ label!</del>regx è¿›è¡Œæ’é™¤ï¼›</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæƒ³æŸ¥è¯¢å¤šä¸ªç¯èŠ‚ä¸‹çš„æ—¶é—´åºåˆ—åºåˆ—å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¡¨è¾¾å¼ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;environment=~&quot;staging|testing|development&quot;,method!=&quot;GET&quot;&#125;
æ’é™¤ç”¨æ³•
prometheus_http_requests_total&#123;environment!~&quot;staging|testing|development&quot;,method!=&quot;GET&quot;&#125;
</code></pre>
<h3 id="èŒƒå›´æŸ¥è¯¢"><a href="#èŒƒå›´æŸ¥è¯¢" class="headerlink" title="èŒƒå›´æŸ¥è¯¢"></a><strong>èŒƒå›´æŸ¥è¯¢</strong></h3><p>ç›´æ¥é€šè¿‡ç±»ä¼¼äº PromQL è¡¨è¾¾å¼ httprequeststotal æŸ¥è¯¢æ—¶é—´åºåˆ—æ—¶ï¼Œè¿”å›å€¼ä¸­åªä¼šåŒ…å«è¯¥æ—¶é—´åºåˆ—ä¸­çš„æœ€æ–°çš„ä¸€ä¸ªæ ·æœ¬å€¼ï¼Œè¿™æ ·çš„è¿”å›ç»“æœæˆ‘ä»¬ç§°ä¹‹ä¸ºç¬æ—¶å‘é‡ã€‚è€Œç›¸åº”çš„è¿™æ ·çš„è¡¨è¾¾å¼ç§°ä¹‹ä¸º ç¬æ—¶å‘é‡è¡¨è¾¾å¼ã€‚</p>
<p>è€Œå¦‚æœæˆ‘ä»¬æƒ³è¿‡å»ä¸€æ®µæ—¶é—´èŒƒå›´å†…çš„æ ·æœ¬æ•°æ®æ—¶ï¼Œæˆ‘ä»¬åˆ™éœ€è¦ä½¿ç”¨åŒºé—´å‘é‡è¡¨è¾¾å¼ã€‚åŒºé—´å‘é‡è¡¨è¾¾å¼å’Œç¬æ—¶å‘é‡è¡¨è¾¾å¼ä¹‹é—´çš„å·®å¼‚åœ¨äºåœ¨åŒºé—´å‘é‡è¡¨è¾¾å¼ä¸­æˆ‘ä»¬éœ€è¦å®šä¹‰æ—¶é—´é€‰æ‹©çš„èŒƒå›´ï¼Œæ—¶é—´èŒƒå›´é€šè¿‡æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ [] è¿›è¡Œå®šä¹‰ã€‚ ä¾‹å¦‚ï¼Œé€šè¿‡ä»¥ä¸‹è¡¨è¾¾å¼å¯ä»¥é€‰æ‹©</p>
<p>æœ€è¿‘ 5 åˆ†é’Ÿå†…çš„æ‰€æœ‰æ ·æœ¬æ•°æ®ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;&#125;[5m]
</code></pre>
<p>é€šè¿‡åŒºé—´å‘é‡è¡¨è¾¾å¼æŸ¥è¯¢åˆ°çš„ç»“æœæˆ‘ä»¬ç§°ä¸ºåŒºé—´å‘é‡ã€‚ é™¤äº†ä½¿ç”¨ m è¡¨ç¤ºåˆ†é’Ÿä»¥å¤–ï¼Œ</p>
<p>PromQL çš„æ—¶é—´èŒƒå›´é€‰æ‹©å™¨æ”¯æŒå…¶å®ƒæ—¶é—´å•ä½ï¼š</p>
<pre><code>s - ç§’
m - åˆ†é’Ÿ
h - å°æ—¶
d - å¤©
w - å‘¨
y - å¹´
</code></pre>
<h3 id="æ—¶é—´ä½ç§»æ“ä½œ"><a href="#æ—¶é—´ä½ç§»æ“ä½œ" class="headerlink" title="æ—¶é—´ä½ç§»æ“ä½œ"></a>æ—¶é—´ä½ç§»æ“ä½œ</h3><p>åœ¨ç¬æ—¶å‘é‡è¡¨è¾¾å¼æˆ–è€…åŒºé—´å‘é‡è¡¨è¾¾å¼ä¸­ï¼Œéƒ½æ˜¯ä»¥å½“å‰æ—¶é—´ä¸ºåŸºå‡†ï¼š</p>
<pre><code>prometheus_http_requests_total&#123;&#125; # ç¬æ—¶å‘é‡è¡¨è¾¾å¼ï¼Œé€‰æ‹©å½“å‰æœ€æ–°çš„æ•°æ® 
prometheus_http_requests_total&#123;&#125;[5m] # åŒºé—´å‘é‡è¡¨è¾¾å¼ï¼Œé€‰æ‹©ä»¥å½“å‰æ—¶é—´ä¸ºåŸºå‡†ï¼Œ5 åˆ†é’Ÿå†…çš„æ•°æ®
</code></pre>
<p>è€Œå¦‚æœæˆ‘ä»¬æƒ³æŸ¥è¯¢ï¼Œ5 åˆ†é’Ÿå‰çš„ç¬æ—¶æ ·æœ¬æ•°æ®ï¼Œæˆ–æ˜¨å¤©ä¸€å¤©çš„åŒºé—´å†…çš„æ ·æœ¬æ•°æ®å‘¢? è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä½ç§»æ“ä½œï¼Œä½ç§»æ“ä½œçš„å…³é”®å­—ä¸º <strong>offset</strong>ã€‚ å¯ä»¥ä½¿ç”¨ offset æ—¶é—´ä½ç§»æ“ä½œï¼š</p>
<pre><code>prometheus_http_requests_total&#123;&#125; offset 5m
prometheus_http_requests_total&#123;&#125;[1d] offset 1d
</code></pre>
<h3 id="ä½¿ç”¨èšåˆæ“ä½œ"><a href="#ä½¿ç”¨èšåˆæ“ä½œ" class="headerlink" title="ä½¿ç”¨èšåˆæ“ä½œ"></a>ä½¿ç”¨èšåˆæ“ä½œ</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæè¿°æ ·æœ¬ç‰¹å¾çš„æ ‡ç­¾(label)åœ¨å¹¶éå”¯ä¸€çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ PromQL æŸ¥è¯¢æ•°æ®ï¼Œä¼šè¿”å›å¤šæ¡æ»¡è¶³è¿™äº›ç‰¹å¾ç»´åº¦çš„æ—¶é—´åºåˆ—ã€‚è€Œ PromQL æä¾›çš„èšåˆæ“ä½œå¯ä»¥ç”¨æ¥å¯¹è¿™äº›æ—¶é—´åºåˆ—è¿›è¡Œå¤„ç†ï¼Œå½¢æˆä¸€æ¡æ–°çš„æ—¶é—´åºåˆ—ï¼š</p>
<pre><code># æŸ¥è¯¢ç³»ç»Ÿæ‰€æœ‰ http è¯·æ±‚çš„æ€»é‡
sum(prometheus_http_requests_total)
# æŒ‰ç…§ mode è®¡ç®—ä¸»æœº CPU çš„å¹³å‡ä½¿ç”¨æ—¶é—´
avg(node_cpu_seconds_total) by (mode)
# æŒ‰ç…§ä¸»æœºæŸ¥è¯¢å„ä¸ªä¸»æœºçš„ CPU ä½¿ç”¨ç‡
sum(sum(irate(node_cpu_seconds_total&#123;mode!=&#39;idle&#39;&#125;[5m])) /  sum(irate(node_cpu_seconds_total [5m]))) by (instance)
</code></pre>
<h3 id="æ ‡é‡å’Œå­—ç¬¦ä¸²"><a href="#æ ‡é‡å’Œå­—ç¬¦ä¸²" class="headerlink" title="æ ‡é‡å’Œå­—ç¬¦ä¸²"></a>æ ‡é‡å’Œå­—ç¬¦ä¸²</h3><p>é™¤äº†ä½¿ç”¨ç¬æ—¶å‘é‡è¡¨è¾¾å¼å’ŒåŒºé—´å‘é‡è¡¨è¾¾å¼ä»¥å¤–ï¼ŒPromQL è¿˜ç›´æ¥æ”¯æŒç”¨æˆ·ä½¿ç”¨æ ‡é‡(Scalar)å’Œå­—ç¬¦ä¸²(String)ã€‚</p>
<p>â¢ æ ‡é‡ï¼ˆScalarï¼‰ï¼šä¸€ä¸ªæµ®ç‚¹å‹çš„æ•°å­—å€¼</p>
<p>æ ‡é‡åªæœ‰ä¸€ä¸ªæ•°å­—ï¼Œæ²¡æœ‰æ—¶åºã€‚ ä¾‹å¦‚ï¼š10</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨è¡¨è¾¾å¼ count(prometheus_http_requests_total)ï¼Œè¿”å›çš„æ•°æ®ç±»å‹ï¼Œä¾ç„¶æ˜¯ç¬æ—¶å‘é‡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å†…ç½®å‡½æ•°scalar()å°†å•ä¸ªç¬æ—¶å‘é‡è½¬æ¢ä¸ºæ ‡é‡ã€‚</p>
<p>â¢ å­—ç¬¦ä¸²ï¼ˆStringï¼‰ï¼šä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²å€¼</p>
<p>ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œä½œä¸ºPromQL è¡¨è¾¾å¼ï¼Œåˆ™ä¼šç›´æ¥è¿”å›å­—ç¬¦ä¸²ã€‚</p>
<pre><code>&quot;this is a string&quot;
&#39;these are unescaped: \n \\ \t&#39;
`these are not unescaped: \n &#39; &quot; \t
</code></pre>
<h3 id="åˆæ³•çš„-PromQL-è¡¨è¾¾å¼"><a href="#åˆæ³•çš„-PromQL-è¡¨è¾¾å¼" class="headerlink" title="åˆæ³•çš„ PromQL è¡¨è¾¾å¼"></a>åˆæ³•çš„ PromQL è¡¨è¾¾å¼</h3><p>æ‰€æœ‰çš„ PromQL è¡¨è¾¾å¼éƒ½<strong>å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ªæŒ‡æ ‡åç§°</strong>(ä¾‹å¦‚ http_request_total)ï¼Œæˆ–è€…ä¸€ä¸ª<strong>ä¸ä¼šåŒ¹é…åˆ°ç©ºå­—ç¬¦ä¸²</strong>çš„æ ‡ç­¾è¿‡æ»¤å™¨(ä¾‹å¦‚{code&#x3D;â€200â€})ã€‚</p>
<pre><code>å› æ­¤ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼Œå‡ä¸ºåˆæ³•çš„è¡¨è¾¾å¼ï¼š
prometheus_http_requests_total # åˆæ³•
prometheus_http_requests_total&#123;&#125; # åˆæ³•
&#123;method=&quot;get&quot;&#125; # åˆæ³•

è€Œå¦‚ä¸‹è¡¨è¾¾å¼ï¼Œåˆ™ä¸åˆæ³•ï¼š
&#123;job=~&quot;.*&quot;&#125; # ä¸åˆæ³•

åŒæ—¶ï¼Œé™¤äº†ä½¿ç”¨  &#123;label=value&#125;  çš„å½¢å¼ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å†…ç½®çš„ name æ ‡ç­¾æ¥æŒ‡å®šç›‘æ§æŒ‡æ ‡åç§°ï¼š
&#123;  name  =~&quot;prometheus_http_requests_total&quot;&#125; # åˆæ³•
&#123;  name  =~&quot;node_disk_bytes_read|node_disk_bytes_written&quot;&#125; # åˆæ³•
</code></pre>
<h3 id="PromQL-æ“ä½œç¬¦"><a href="#PromQL-æ“ä½œç¬¦" class="headerlink" title="PromQL æ“ä½œç¬¦"></a>PromQL æ“ä½œç¬¦</h3><p>ä½¿ç”¨PromQL é™¤äº†èƒ½å¤Ÿæ–¹ä¾¿çš„æŒ‰ç…§æŸ¥è¯¢å’Œè¿‡æ»¤æ—¶é—´åºåˆ—ä»¥å¤–ï¼ŒPromQL è¿˜æ”¯æŒä¸°å¯Œçš„æ“ä½œç¬¦ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è¿™äº›æ“ä½œç¬¦å¯¹è¿›ä¸€æ­¥çš„å¯¹äº‹ä»¶åºåˆ—è¿›è¡ŒäºŒæ¬¡åŠ å·¥ã€‚è¿™äº›æ“ä½œç¬¦åŒ…æ‹¬ï¼šæ•°å­¦è¿ç®—ç¬¦ï¼Œé€»è¾‘è¿ç®—ç¬¦ï¼Œå¸ƒå°”è¿ç®—ç¬¦ç­‰ç­‰ã€‚</p>
<pre><code>æ•°å­¦è¿ç®—
+ (åŠ æ³•)
- (å‡æ³•)
* (ä¹˜æ³•)
/ (é™¤æ³•)
% (æ±‚ä½™)
^ (å¹‚è¿ç®—)

å¸ƒå°”è¿ç®—
== (ç›¸ç­‰)
!= (ä¸ç›¸ç­‰)
&gt;(å¤§äº)
&lt; (å°äº)
&gt;= (å¤§äºç­‰äº)
&lt;= (å°äºç­‰äº)
</code></pre>
<p>â¢ ä½¿ç”¨bool ä¿®é¥°ç¬¦æ”¹å˜å¸ƒå°”è¿ç®—ç¬¦çš„è¡Œä¸º</p>
<p>å¸ƒå°”è¿ç®—ç¬¦çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹æ—¶åºæ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚è€Œåœ¨å…¶å®ƒçš„æƒ…å†µä¸‹æˆ‘ä»¬å¯èƒ½éœ€è¦çš„æ˜¯çœŸæ­£çš„å¸ƒå°”ç»“æœã€‚ä¾‹å¦‚ï¼Œåªéœ€è¦ çŸ¥é“å½“å‰æ¨¡å—çš„ HTTP è¯·æ±‚é‡æ˜¯å¦&gt;&#x3D;1000ï¼Œå¦‚æœå¤§äºç­‰äº1000 åˆ™è¿”å› 1ï¼ˆtrueï¼‰å¦åˆ™è¿”å› 0ï¼ˆfalseï¼‰ã€‚è¿™æ—¶å¯ä»¥ä½¿ ç”¨ bool ä¿®é¥°ç¬¦æ”¹å˜å¸ƒå°”è¿ç®—çš„é»˜è®¤è¡Œä¸ºã€‚ ä¾‹å¦‚ï¼š</p>
<p>prometheus_http_requests_total &gt; bool 1000<br>ä½¿ç”¨ bool ä¿®æ”¹ç¬¦åï¼Œå¸ƒå°”è¿ç®—ä¸ä¼šå¯¹æ—¶é—´åºåˆ—è¿›è¡Œè¿‡æ»¤ï¼Œè€Œæ˜¯ç›´æ¥ä¾æ¬¡ç¬æ—¶å‘é‡ä¸­çš„å„ä¸ªæ ·æœ¬æ•°æ®ä¸æ ‡é‡çš„æ¯”è¾ƒç»“æœ 0 æˆ–è€… 1ã€‚ä»è€Œå½¢æˆä¸€æ¡æ–°çš„æ—¶é—´åºåˆ—ã€‚</p>
<p>åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯åœ¨ä¸¤ä¸ªæ ‡é‡ä¹‹é—´ä½¿ç”¨å¸ƒå°”è¿ç®—ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ bool ä¿®é¥°ç¬¦ï¼š2 &#x3D;&#x3D; bool 2 # ç»“æœä¸º 1</p>
<h3 id="ä½¿ç”¨é›†åˆè¿ç®—ç¬¦"><a href="#ä½¿ç”¨é›†åˆè¿ç®—ç¬¦" class="headerlink" title="ä½¿ç”¨é›†åˆè¿ç®—ç¬¦"></a>ä½¿ç”¨é›†åˆè¿ç®—ç¬¦</h3><p>ä½¿ç”¨ç¬æ—¶å‘é‡è¡¨è¾¾å¼èƒ½å¤Ÿè·å–åˆ°ä¸€ä¸ªåŒ…å«å¤šä¸ªæ—¶é—´åºåˆ—çš„é›†åˆï¼Œæˆ‘ä»¬ç§°ä¸ºç¬æ—¶å‘é‡ã€‚é€šè¿‡é›†åˆè¿ç®—ï¼Œå¯ä»¥åœ¨ä¸¤ä¸ªç¬æ—¶å‘é‡ä¸ç¬æ—¶å‘é‡ä¹‹é—´è¿›è¡Œç›¸åº”çš„é›†åˆæ“ä½œã€‚</p>
<p>ç›®å‰ï¼ŒPrometheus æ”¯æŒä»¥ä¸‹é›†åˆè¿ç®—ç¬¦ï¼š</p>
<pre><code>and (å¹¶ä¸”)
or (æˆ–è€…)
unless (æ’é™¤)
</code></pre>
<p>vector1 and vector2 ä¼šäº§ç”Ÿä¸€ä¸ªç”± vector1 çš„å…ƒç´ ç»„æˆçš„æ–°çš„å‘é‡ã€‚è¯¥å‘é‡åŒ…å«vector1 ä¸­å®Œå…¨åŒ¹é… vector2 ä¸­çš„å…ƒç´ ç»„æˆã€‚</p>
<p>vector1 or vector2 ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å‘é‡ï¼Œè¯¥å‘é‡åŒ…å« vector1 ä¸­æ‰€æœ‰çš„æ ·æœ¬æ•°æ®ï¼Œä»¥åŠ vector2 ä¸­æ²¡æœ‰ä¸ vector1 åŒ¹é…åˆ°çš„æ ·æœ¬æ•°æ®ã€‚</p>
<p>vector1 unless vector2 ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å‘é‡ï¼Œæ–°å‘é‡ä¸­çš„å…ƒç´ ç”± vector1 ä¸­æ²¡æœ‰ä¸vector2 åŒ¹é…çš„å…ƒç´ ç»„æˆã€‚</p>
<h3 id="æ“ä½œç¬¦ä¼˜å…ˆçº§"><a href="#æ“ä½œç¬¦ä¼˜å…ˆçº§" class="headerlink" title="æ“ä½œç¬¦ä¼˜å…ˆçº§"></a>æ“ä½œç¬¦ä¼˜å…ˆçº§</h3><p>å¯¹äºå¤æ‚ç±»å‹çš„è¡¨è¾¾å¼ï¼Œéœ€è¦äº†è§£è¿ç®—æ“ä½œçš„è¿è¡Œä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢ä¸»æœºçš„ CPU ä½¿ç”¨ç‡ï¼Œå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼š</p>
<pre><code>100 * (1 - avg (irate(node_cpu_seconds_total&#123;mode=&#39;idle&#39;&#125;[5m])) by(job) ) 
</code></pre>
<p>å…¶ä¸­irate æ˜¯PromQLä¸­çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºè®¡ç®—åŒºé—´å‘é‡ä¸­æ—¶é—´åºåˆ—æ¯ç§’çš„å³æ—¶å¢é•¿ç‡ã€‚åœ¨ PromQL æ“ä½œç¬¦ä¸­ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š</p>
<pre><code>^
*, /, %
+, -
==, !=, &lt;=, =, &gt;
and, unless
or
</code></pre>
<h3 id="PromQL-èšåˆæ“ä½œ"><a href="#PromQL-èšåˆæ“ä½œ" class="headerlink" title="PromQL èšåˆæ“ä½œ"></a>PromQL èšåˆæ“ä½œ</h3><p>Prometheus è¿˜æä¾›äº†ä¸‹åˆ—å†…ç½®çš„èšåˆæ“ä½œç¬¦ï¼Œè¿™äº›æ“ä½œç¬¦ä½œç”¨åŸŸç¬æ—¶å‘é‡ã€‚å¯ä»¥å°†ç¬æ—¶è¡¨è¾¾å¼è¿”å›çš„æ ·æœ¬æ•°æ®è¿›è¡Œ èšåˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ—¶é—´åºåˆ—ã€‚</p>
<pre><code>sum (æ±‚å’Œ)
min (æœ€å°å€¼)
max (æœ€å¤§å€¼)
avg (å¹³å‡å€¼)

stddev (æ ‡å‡†å·®)
stdvar (æ ‡å‡†å·®å¼‚)
count (è®¡æ•°)
count_values (å¯¹ value è¿›è¡Œè®¡æ•°)
bottomk (å n æ¡æ—¶åº)
topk (å‰n æ¡æ—¶åº)
quantile (åˆ†å¸ƒç»Ÿè®¡)
</code></pre>
<p>ä½¿ç”¨èšåˆæ“ä½œçš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code>&lt;aggr-op&gt;([parameter,] &lt;vector expression&gt;) [without|by (&lt;label list&gt;)] 
</code></pre>
<p>å…¶ä¸­åªæœ‰ count_values , quantile , topk , bottomk æ”¯æŒå‚æ•°(parameter)ã€‚</p>
<p>without ç”¨äºä»è®¡ç®—ç»“æœä¸­ç§»é™¤åˆ—ä¸¾çš„æ ‡ç­¾ï¼Œè€Œä¿ç•™å…¶å®ƒæ ‡ç­¾ã€‚by åˆ™æ­£å¥½ç›¸åï¼Œç»“æœå‘é‡ä¸­åªä¿ç•™åˆ—å‡ºçš„æ ‡ç­¾ï¼Œå…¶ä½™æ ‡ç­¾åˆ™ç§»é™¤ã€‚é€šè¿‡ without å’Œ by å¯ä»¥æŒ‰ç…§æ ·æœ¬çš„é—®é¢˜å¯¹æ•°æ®è¿›è¡Œèšåˆã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code>sum(prometheus_http_requests_total) without (instance)                  ç­‰ä»·äº
sum(prometheus_http_requests_total) by (code,handler,job,method)       
</code></pre>
<p>å¦‚æœåªéœ€è¦è®¡ç®—æ•´ä¸ªåº”ç”¨çš„ HTTP è¯·æ±‚æ€»é‡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¡¨è¾¾å¼ï¼šsum(prometheus_http_requests_total)</p>
<p>count_values ç”¨äºæ—¶é—´åºåˆ—ä¸­æ¯ä¸€ä¸ªæ ·æœ¬å€¼å‡ºç°çš„æ¬¡æ•°ã€‚count_values ä¼šä¸ºæ¯ä¸€ä¸ªå”¯ä¸€çš„æ ·æœ¬å€¼è¾“å‡ºä¸€ä¸ªæ—¶é—´åºåˆ—ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªæ—¶é—´åºåˆ—åŒ…å«ä¸€ä¸ªé¢å¤–çš„æ ‡ç­¾ã€‚ ä¾‹å¦‚ï¼šcount_values(â€œcountâ€, prometheus_http_requests_total)</p>
<p>topk å’Œ bottomk åˆ™ç”¨äºå¯¹æ ·æœ¬å€¼è¿›è¡Œæ’åºï¼Œè¿”å›å½“å‰æ ·æœ¬å€¼å‰ n ä½ï¼Œæˆ–è€…å n ä½çš„æ—¶é—´åºåˆ—ã€‚</p>
<p>è·å– HTTP è¯·æ±‚æ•°å‰ 5 ä½çš„æ—¶åºæ ·æœ¬æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼štopk(5, prometheus_http_requests_total)</p>
<p>quantile ç”¨äºè®¡ç®—å½“å‰æ ·æœ¬æ•°æ®å€¼çš„åˆ†å¸ƒæƒ…å†µ quantile(Ï†, express)å…¶ä¸­ 0 â‰¤ Ï† â‰¤ 1ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“Ï† ä¸º 0.5 æ—¶ï¼Œå³è¡¨ç¤ºæ‰¾åˆ°å½“å‰æ ·æœ¬æ•°æ®ä¸­çš„ä¸­ä½æ•°ï¼šquantile(0.5, prometheus_http_requests_total)</p>
<h1 id="å…­ã€Prometheus-å’Œ-Grafana-é›†æˆ"><a href="#å…­ã€Prometheus-å’Œ-Grafana-é›†æˆ" class="headerlink" title="å…­ã€Prometheus å’Œ Grafana é›†æˆ"></a>å…­ã€Prometheus å’Œ Grafana é›†æˆ</h1><p>å®˜ç½‘ä¸‹è½½å®‰è£…ï¼š<a target="_blank" rel="noopener" href="https://grafana.com/grafana/download">https://grafana.com/grafana/download</a></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615225957649.png" alt="image-20220615225957649"></p>
<h3 id="1ã€å®‰è£…"><a href="#1ã€å®‰è£…" class="headerlink" title="1ã€å®‰è£…"></a>1ã€å®‰è£…</h3><pre><code>wget https://dl.grafana.com/enterprise/release/grafana-enterprise-8.5.5-1.x86_64.rpmsudo 
yum install grafana-enterprise-8.5.5-1.x86_64.rpm

æ¨èä½¿ç”¨å®‰è£…å‹ç¼©åŒ…,ä¸‹è½½åˆ°optç›®å½•ä¸‹
wget https://dl.grafana.com/enterprise/release/grafana-enterprise-9.0.0.linux-amd64.tar.gz
tar -zxvf grafana -enterprise-9.0.0.linux-amd64.tar.gz
</code></pre>
<h3 id="2ã€å¯åŠ¨æœåŠ¡ä½¿ç”¨"><a href="#2ã€å¯åŠ¨æœåŠ¡ä½¿ç”¨" class="headerlink" title="2ã€å¯åŠ¨æœåŠ¡ä½¿ç”¨"></a>2ã€å¯åŠ¨æœåŠ¡ä½¿ç”¨</h3><pre><code>systemd å¯åŠ¨æœåŠ¡å™¨  
sudo systemctl daemon-reload   
sudo systemctl start grafana-server   
sudo systemctl status grafana-server
service grafana-server stop

åå°å¯åŠ¨
nohup ./bin/grafana-server web &gt; ./grafana.log 2&gt;&amp;1 &amp;
# æ‰“å¼€webï¼šhttp://hadoop202:3000,é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼šadmin
</code></pre>
<h3 id="3ã€é…ç½®æ•°æ®æº"><a href="#3ã€é…ç½®æ•°æ®æº" class="headerlink" title="3ã€é…ç½®æ•°æ®æº"></a>3ã€é…ç½®æ•°æ®æº</h3><p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615230303285.png" alt="image-20220615230303285"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220615230459521.png" alt="image-20220615230459521"></p>
<h3 id="4ã€æ‰‹åŠ¨åˆ›å»ºä»ªè¡¨ç›˜-Dashboard"><a href="#4ã€æ‰‹åŠ¨åˆ›å»ºä»ªè¡¨ç›˜-Dashboard" class="headerlink" title="4ã€æ‰‹åŠ¨åˆ›å»ºä»ªè¡¨ç›˜ Dashboard"></a>4ã€æ‰‹åŠ¨åˆ›å»ºä»ªè¡¨ç›˜ Dashboard</h3><p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616214322877.png" alt="image-20220616214322877"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616214536938.png" alt="image-20220616214536938"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616214800778.png" alt="image-20220616214800778"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616214913538.png" alt="image-20220616214913538"></p>
<p>ä¸€ä¸ªä»ªè¡¨æ¿å¯ä»¥é…ç½®å¤šä¸ªç›‘æ§é¡¹ï¼Œæ·»åŠ å…¶ä»–ç›‘æ§é¡¹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616215134283.png" alt="image-20220616215134283"></p>
<p>åˆ›å»ºå¤šä¸ªpanelåï¼Œå¯æ‹–åŠ¨å›¾è¡¨ï¼Œæ”¾åˆ°å…¶ä»–rowä¸­</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616215907029.png" alt="image-20220616215907029"></p>
<h3 id="5ã€-Dashboard-æ¨¡æ¿"><a href="#5ã€-Dashboard-æ¨¡æ¿" class="headerlink" title="5ã€ Dashboard æ¨¡æ¿"></a>5ã€ Dashboard æ¨¡æ¿</h3><p>æ‰‹åŠ¨ä¸€ä¸ªä¸ªæ·»åŠ  Dashboard æ¯”è¾ƒç¹çï¼ŒGrafana ç¤¾åŒºé¼“åŠ±ç”¨æˆ·åˆ†äº« Dashboardï¼Œé€šè¿‡<a target="_blank" rel="noopener" href="https://grafana.com/dashboards">https://grafana.com/dashboards</a> ç½‘ç«™ï¼Œå¯ä»¥æ‰¾åˆ°å¤§é‡å¯ç›´æ¥ä½¿ç”¨çš„ Dashboard æ¨¡æ¿ã€‚</p>
<p>Grafana ä¸­æ‰€æœ‰çš„Dashboard é€šè¿‡ JSON è¿›è¡Œå…±äº«ï¼Œä¸‹è½½å¹¶ä¸”å¯¼å…¥è¿™äº› JSON æ–‡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å·²ç»å®šä¹‰å¥½çš„ Dashboard</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616222321846.png" alt="image-20220616222321846"></p>
<p>ä¸‹è½½JSONæ–‡ä»¶</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616222344832.png" alt="image-20220616222344832"></p>
<p>å¯¼å…¥æ¨¡æ¿</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616222414302.png" alt="image-20220616222414302"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616222619951.png" alt="image-20220616222619951"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220616222803123.png" alt="image-20220616222803123"></p>
<h3 id="6ã€é…ç½®å…å¯†ç™»å½•"><a href="#6ã€é…ç½®å…å¯†ç™»å½•" class="headerlink" title="6ã€é…ç½®å…å¯†ç™»å½•"></a>6ã€é…ç½®å…å¯†ç™»å½•</h3><pre><code>é¦–å…ˆgrafanaé»˜è®¤éœ€è¦ç™»å½•æ‰å¯ä½¿ç”¨ï¼Œåˆå§‹ç”¨æˆ·åå’Œå¯†ç ä¸ºadmin/admin.
grafanaä¹Ÿæä¾›äº†åŒ¿åç™»å½•ï¼Œå³æ— é¡»ç™»å½•å³å¯è¿›å…¥grafanaé¢æ¿ï¼Œç¼–è¾‘confç›®å½•ä¸‹çš„default.iniæ–‡ä»¶å°±å¯ä»¥åšåˆ°ã€‚

é»˜è®¤ç›®å½•/var/share/garafana/confä¸‹é¢ï¼Œå¼€å¯å…å¯†ç™»å…¥ï¼Œenabledæ”¹æˆtrue
</code></pre>
<pre><code>Â [auth.anonymous]
 
Â # enable anonymous access
 
enabled = trueÂ  Â  Â  Â  Â #é»˜è®¤false
 
# specify role for unauthenticated users
 
org_role = ViewerÂ  Â  #é»˜è®¤Viewer
</code></pre>
<h1 id="ä¸ƒã€å®æˆ˜"><a href="#ä¸ƒã€å®æˆ˜" class="headerlink" title="ä¸ƒã€å®æˆ˜"></a>ä¸ƒã€å®æˆ˜</h1><h2 id="1ã€ç›‘æ§RabbitMq"><a href="#1ã€ç›‘æ§RabbitMq" class="headerlink" title="1ã€ç›‘æ§RabbitMq"></a>1ã€ç›‘æ§RabbitMq</h2><p>ç¬¬ä¸€ç§ï¼šRabbitMQå†…éƒ¨é›†æˆPrometheusæ¥è·å–æŒ‡æ ‡</p>
<ul>
<li>3.8.0ä¹‹å‰ç‰ˆæœ¬ï¼ŒRabbitMQå¯ä»¥ä½¿ç”¨å•ç‹¬çš„æ’ä»¶prometheus_rabbitmq_exporteræ¥å‘Prometheuså…¬å¼€æŒ‡æ ‡ï¼Œè¦å•ç‹¬ä¸‹è½½åˆ°RabbitMQå®‰è£…ç›®å½•ä¸­è¿›è¡Œå®‰è£…ï¼›</li>
</ul>
<p>ã€€ã€€ã€€prometheus_rabbitmq_exporterï¼š<a target="_blank" rel="noopener" href="https://github.com/deadtrickster/prometheus_rabbitmq_exporter">https://github.com/deadtrickster/prometheus_rabbitmq_exporter</a></p>
<ul>
<li>3.8.0ç‰ˆå¼€å§‹ï¼ŒRabbitMQé™„å¸¦äº†å†…ç½®çš„Prometheusï¼†Grafanaæ”¯æŒã€‚è™½ç„¶å†…ç½®äº†è¯¥æ’ä»¶ï¼Œä½†ä¹Ÿè¦è¿›è¡Œå®‰è£…</li>
</ul>
<p>ã€€ã€€  rabbitmq-prometheusï¼š<a target="_blank" rel="noopener" href="https://github.com/rabbitmq/rabbitmq-prometheus">https://github.com/rabbitmq/rabbitmq-prometheus</a></p>
<p>ç¬¬äºŒç§ï¼šä½¿ç”¨ç‹¬ç«‹ç¨‹åºæ¥è·å–æŒ‡æ ‡ï¼ˆRabbitMQ_exporterï¼‰</p>
<p>ã€€ã€€ä¸ç®¡ä»€ä¹ˆç‰ˆæœ¬éƒ½èƒ½ä½¿ç”¨ï¼Œè¦å•ç‹¬å¯åŠ¨exporterè¿›ç¨‹</p>
<p>ã€€ã€€rabbitmq_exporterï¼š<a target="_blank" rel="noopener" href="https://github.com/kbudde/rabbitmq_exporter">https://github.com/kbudde/rabbitmq_exporter</a></p>
<p>RabbitMQ å®˜æ–¹ç›‘æ§ä»‹ç»ï¼š </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.rabbitmq.com/monitoring.html">https://www.rabbitmq.com/monitoring.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.rabbitmq.com/prometheus.html#overview-prometheus">https://www.rabbitmq.com/prometheus.html#overview-prometheus</a></li>
</ul>
<p><strong>æ¥ä¸‹æ¥é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼</strong></p>
<p>å®‰è£…rabbitmq_exporter</p>
<p>æ³¨ï¼šåœ¨RabbitMQé›†ç¾¤ä¸‹çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹éƒ¨ç½²å®ƒã€‚</p>
<ul>
<li><strong>ä¸Šä¼ è§£å‹</strong></li>
</ul>
<p>ä» <a target="_blank" rel="noopener" href="https://github.com/kbudde/rabbitmq_exporter/releases">https://github.com/kbudde/rabbitmq_exporter/releases</a> ä¸‹è½½å¹¶ä¸Šä¼ rabbitmq_exporter_1.0.0-RC16_linux_amd64.tar.gzå®‰è£…åŒ…å¹¶è§£å‹åˆ°&#x2F;usr&#x2F;localç›®å½•</p>
<pre><code>tar -xvf rabbitmq_exporter_1.0.0-RC16_linux_amd64.tar.gz
cd rabbitmq_exporter_1.0.0-RC16_linux_amd64/
</code></pre>
<ul>
<li><strong>é…ç½®</strong></li>
</ul>
<p>ä½¿ç”¨é»˜è®¤é…ç½®</p>
<ul>
<li><strong>å¯åŠ¨</strong></li>
</ul>
<p>è¿›å…¥æ ¹ç›®å½•ä¸‹ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code>cd /usr/local/rabbitmq_exporter_1.0.0-RC16_linux_amd64
RABBIT_USER=zat RABBIT_PASSWORD=zat123 OUTPUT_FORMAT=json PUBLISH_PORT=9090 RABBIT_URL=http://localhost:15672 nohup ./rabbitmq_exporter &amp;
tail -1000f nohup.out
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<p>RABBIT_USERï¼šrabbitç”¨æˆ·å</p>
<p>RABBIT_PASSWORDï¼šrabbitå¯†ç </p>
<p>RABBIT_URLï¼šrabbitæœåŠ¡åœ°å€å’Œç«¯å£</p>
<p>OUTPUT_FORMATï¼šè¾“å‡ºæ ¼å¼</p>
<p>PUBLIC_PORTï¼šæš´éœ²ç«¯å£</p>
<p>å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="http://ip:9090/metrics/">http://IP:9090/metrics/</a> ï¼Œï¼ˆIPå’Œç«¯å£è¦æ”¹æˆç›¸åº”ç¯å¢ƒçš„ï¼‰</p>
<p>çœ‹æŠ“å–çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617095924813.png" alt="image-20220617095924813"></p>
<p><strong>Prometheusé…ç½®</strong></p>
<p>ä¿®æ”¹prometheusç»„ä»¶çš„prometheus.ymlåŠ å…¥rabbitMQèŠ‚ç‚¹ï¼š</p>
<pre><code class="yml">    
# æ·»åŠ  rabbitmq_export ç›‘æ§é…ç½®
  - job_name: &#39;rabbitmq_export&#39;
    scrape_interval: 60s
    scrape_timeout: 60s
    static_configs:
    - targets: [&#39;127.0.0.1:19090&#39;]
</code></pre>
<p>å…ˆkillæ‰Prometheusè¿›ç¨‹ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤é‡å¯å®ƒï¼Œç„¶åæŸ¥çœ‹targetsï¼š</p>
<p><strong>Grafanaé…ç½®</strong></p>
<p>ä¸‹è½½å¯¹åº”çš„æ¨¡æ¿ï¼Œä¸éœ€è¦ä¿®æ”¹å³å¯ä½¿ç”¨</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617104125774.png" alt="image-20220617104125774"></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617104148302.png" alt="image-20220617104148302"></p>
<h2 id="2ã€ç›‘æ§liunxæœåŠ¡å™¨"><a href="#2ã€ç›‘æ§liunxæœåŠ¡å™¨" class="headerlink" title="2ã€ç›‘æ§liunxæœåŠ¡å™¨"></a>2ã€ç›‘æ§liunxæœåŠ¡å™¨</h2><p>ä¸‹è½½æ¨¡æ¿</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617105854848.png" alt="image-20220617105854848"></p>
<h2 id="3ã€ç›‘æ§mysqlæœåŠ¡"><a href="#3ã€ç›‘æ§mysqlæœåŠ¡" class="headerlink" title="3ã€ç›‘æ§mysqlæœåŠ¡"></a>3ã€ç›‘æ§mysqlæœåŠ¡</h2><p>1ã€mysqld_exporterä¸‹è½½ <a target="_blank" rel="noopener" href="https://prometheus.io/download/">https://prometheus.io/download/</a></p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617113926523.png" alt="image-20220617113926523"></p>
<pre><code>1ã€ä¸Šä¼  mysqld_exporter-0.14.0.linux-amd64.tar.gz
2ã€tar  -zxvf  mysqld_exporter-0.14.0.linux-amd64.tar.gz -C /opt/module
3ã€å½“å‰ç›®å½•ä¸‹æ–°å»ºé…ç½®æ–‡ä»¶ my.cnf
</code></pre>
<p>2ã€ä¿®æ”¹ my.cnfé…ç½®mysqlä¿¡æ¯</p>
<pre><code>[client]
host=127.0.0.1
user= root
password=root
</code></pre>
<p>3ã€å¯åŠ¨æœåŠ¡</p>
<pre><code>nohup ./mysqld_exporter --config.my-cnf=/opt/system_detection/mysqld_exporter-0.14.0.linux-amd64/my.cnf &gt;mysqld_exporter.log 2&gt;&amp;1 &amp;
</code></pre>
<p>è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://127.0.0.1:9104/metrics">http://127.0.0.1:9104/metrics</a> æŸ¥çœ‹</p>
<p>4ã€ä¿®æ”¹prometheusç»„ä»¶çš„prometheus.ymlåŠ å…¥mysqlèŠ‚ç‚¹ï¼š</p>
<pre><code># æ·»åŠ  mysql_export ç›‘æ§é…ç½®
  - job_name: &#39;mysql_export&#39;
    scrape_interval: 60s
    scrape_timeout: 60s
    static_configs:
    - targets: [&#39;127.0.0.1:9104&#39;]
</code></pre>
<p>5ã€ä¸‹è½½æ¨¡æ¿</p>
<p><img src="https://raw.githubusercontent.com/lukaixin0527/images/master/java-img/image-20220617114409963.png" alt="image-20220617114409963"></p>
<h2 id="4ã€ç›‘æ§springbootæœåŠ¡"><a href="#4ã€ç›‘æ§springbootæœåŠ¡" class="headerlink" title="4ã€ç›‘æ§springbootæœåŠ¡"></a>4ã€ç›‘æ§springbootæœåŠ¡</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38225558/article/details/117696800">https://blog.csdn.net/qq_38225558/article/details/117696800</a></p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ xiaomumu527@gmial.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '56edcd306f2975bb61cf',
            clientSecret: '0074cacd48a60a4b7249826b1ccdc7d99a273bb1',
            repo: 'lukaixin0527.github.io',
            owner: 'lukaixin0527',
            admin: ['lukaixin0527'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2016-2020 Yelog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>






<div class="mobile-menus-out" >

</div>
<div class="mobile-menus">
    
    
    
    
    <a class="dynamic-menu " target="_blank"  href="https://github.com/lukaixin0527">github</a>
    
</div>

<div id="musicMouseDrag" style="position:fixed; z-index: 9999; bottom: 0; right: 0;">
<div id="musicDragArea" style="position: absolute; top: 0; left: 0; width: 100%;height: 10px;cursor: move; z-index: 10;"></div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=33761576&auto=1&height=66"></iframe>
</div>

<!--ä»¥ä¸‹ä»£ç æ˜¯ä¸ºäº†æ”¯æŒéšæ—¶æ‹–åŠ¨éŸ³ä¹æ§ä»¶çš„ä½ç½®ï¼Œå¦‚æ²¡æœ‰éœ€æ±‚ï¼Œå¯å»æ‰ä¸‹é¢ä»£ç -->
<script>
var $DOC = $(document)
$('#musicMouseDrag').on('mousedown', function (e) {
// é˜»æ­¢æ–‡æœ¬é€‰ä¸­
$DOC.bind("selectstart", function () {
return false;
});
$('#musicDragArea').css('height', '100%');
var $moveTarget = $('#musicMouseDrag');
$moveTarget.css('border', '1px dashed grey')
var div_x = e.pageX - $moveTarget.offset().left;
var div_y = e.pageY - $moveTarget.offset().top;
$DOC.on('mousemove', function (e) {
var targetX = e.pageX - div_x;
var targetY = e.pageY - div_y;
targetX = targetX < 0 ? 0 : (targetX + $moveTarget.outerWidth() >= window.innerWidth) ? window.innerWidth - $moveTarget.outerWidth() : targetX;
targetY = targetY < 0 ? 0 : (targetY + $moveTarget.outerHeight() >= window.innerHeight) ? window.innerHeight - $moveTarget.outerHeight() : targetY;
$moveTarget.css({'left': targetX + 'px', 'top': targetY + 'px', 'bottom': 'inherit', 'right': 'inherit'})
}).on('mouseup', function () {
$DOC.unbind("selectstart");
$DOC.off('mousemove')
$DOC.off('mouseup')
$moveTarget.css('border', 'none')
$('#musicDragArea').css('height', '10px');
})
})
</script>
</html>
